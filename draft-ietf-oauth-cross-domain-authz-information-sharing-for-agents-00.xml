<?xml version="1.0" encoding="utf-8"?>
<?xml-model href="rfc7991bis.rnc"?>
<!DOCTYPE rfc [
<!ENTITY nbsp "&#160;">
<!ENTITY zwsp "&#8203;">
<!ENTITY nbhy "&#8209;">
<!ENTITY wj "&#8288;">
]>
<rfc xmlns:xi="http://www.w3.org/2001/XInclude" category="info" docName="draft-vc-client-id-metadata-00" ipr="trust200902" submissionType="IETF" xml:lang="en" version="3">
    <front>
        <title abbrev="AuthZ Sharing for Agents">Cross-Domain AuthZ Information sharing for Agents</title>
        <seriesInfo name="Internet-Draft" value="draft-vc-client-id-metadata-00"/>
        <author fullname="Jean Diaconu" surname="Diaconu">
            <address>
                <email>jdiaconu@cisco.com</email>
            </address>
        </author>
        <author fullname="Marcelo Yannuzzi" surname="Yannuzzi">
            <address>
                <email>mayannuz@cisco.com</email>
            </address>
        </author>
        <author fullname="Herve Muyal" surname="Muyal">
            <address>
                <email>hmuyal@cisco.com</email>
            </address>
        </author>
        <author fullname="Frank Brockners" surname="Brockners">
            <address>
                <email>fbrockne@cisco.com</email>
            </address>
        </author>
        <author fullname="Nik Kale" surname="Kale">
            <address>
                <email>nikkal@cisco.com</email>
            </address>
        </author>
        <date year="2025"/>
        <area>Security</area>
        <workgroup>Internet Engineering Task Force</workgroup>
        <abstract>
            <t>Distributed Multi-Agent Systems consist of Agents and MCP Servers operating across multiple administrative domains, each with its own Identity Providers (IdPs) and Authorization Servers (AS).</t>
            <t>This document discusses the challenges and solution approaches for sharing authorization information securely and flexibly across domains, including the use of dynamic identity, interoperable claims, and verifiable credentials.</t>
        </abstract>
    </front>
    <middle>
        <section>
            <name>Introduction</name>
            <t>Distributed Multi-Agent Systems contain Agents and MCP Servers distributed across multiple administrative domains.</t>
            <t>These domains often use different Identity Providers (IdPs) and Authorization Servers (AS), presenting significant challenges for secure, interoperable sharing of authorization information.</t>
        </section>
        <section>
            <name>Abbreviations / Definitions</name>
            <dl>
                <dt>Agent</dt>
                <dd>An autonomous entity that performs tasks on behalf of a user or another program within a multi-agent system.</dd>
                <dt>MCP Server</dt>
                <dd>A program that exposes specific capabilities, like data access or tools, to AI models through the Model Context Protocol (MCP).</dd>
                <dt>AS (Authorization Server)</dt>
                <dd>A server that issues authorization tokens to clients after successfully authenticating them.</dd>
                <dt>IdP (Identity Provider)</dt>
                <dd>A service that creates, manages, and verifies digital identities for users and service users, often for accessing multiple applications and services.</dd>
                <dt>Subject</dt>
                <dd>The principal (user or service).</dd>
                <dt>Claim</dt>
                <dd>Essentially a piece of information asserted about a subject.</dd>
                <dt>Domain</dt>
                <dd>Scope over which a specific, uniform set of security policies and user management rules are enforced.</dd>
            </dl>
        </section>
        <section>
            <name>Problem Statement</name>
            <figure>
                <name>Cross-Domain Multi-Agent Architecture</name>
                <artwork type="ascii-art"><![CDATA[
       Domain A (Organization A)           Domain B (Organization B)
   +-----------------------------+     +-----------------------------+
   |                             |     |                             |
   |      +-------+              |     |              +-------+      |
   |      | Agent |              |---->|              |  MCP  |      |
   |      |       |              |     |              | Server|      |
   |      +---+---+              |     |              +---+---+      |
   |          |                  |     |                  ^          |
   |          | Host/Publish     |     |                  | Protects |
   |          v                  |     |                  |          |
   |  +-------+-------+          |     |          +-------+-------+  |
   |  |   Client-ID   |          |     |          | Authorization |  |
   |  |   Metadata    |          |     |          |    Server     |  |
   |  | (contains VC) |          |     |          |      (AS)     |  |
   |  +---------------+          |     |          +---------------+  |
   |                             |     |                             |
   +-----------------------------+     +-----------------------------+
]]></artwork>
            </figure>
            <t>Distributed Multi-Agent Systems contain Agents and MCP Servers that are distributed across multiple administrative domains. These systems involve different Identity Providers (IdPs) / Authorization Servers (AS) posing challenges in authorization information sharing across these entities.</t>
        </section>
        <section>
            <name>Use Cases</name>
            <section>
                <name>Predictive Threat Detection</name>
                <t><strong>Description:</strong> Enhance security by predicting threats based on behavior analysis.</t>
                <t><strong>Use Case:</strong> An organization uses behavior analysis systems to analyze agent behavior patterns. Client-ID Metadata provides a framework for registering agents, while W3C VCs ensure identity verification and provide additional context for the intended tasks of a specific agent (Ex: may access production logs but not PII).</t>
                <t>The system predicts potential security breaches by assessing deviations in agent behavior and recommends preventive actions, aligning with Zero Trust strategies.</t>
            </section>
            <section>
                <name>Automated Compliance Monitoring</name>
                <t><strong>Description:</strong> Automate compliance checks across distributed systems.</t>
                <t><strong>Use Case:</strong> A financial institution monitors compliance with regulatory requirements. Agents registered through Client-ID Metadata are verified for compliance based on their provided proofs as W3C VCs (Ex: this agent uses this model approved by policy X).</t>
                <t>The system automatically evaluates compliance status based on provided VCs and generates alerts for any discrepancies, ensuring adherence to Zero Trust policies.</t>
            </section>
        </section>
        <section>
            <name>Requirements</name>
            <t>A system for cross-domain sharing of authorization information of agents needs to meet the following set of requirements:</t>
            <ul>
                <li><strong>Dynamic Identity for Agents and MCP Servers:</strong> The Agents and MCP Servers can onboard dynamically and get an assigned identity in the IdP.</li>
                <li><strong>Interoperability Across Domains:</strong> The system must enable seamless interaction between Agents across different domains.</li>
                <li><strong>Flexible Definition of Claims:</strong> Claims should be adaptable as they may vary from organization to organization.</li>
                <li><strong>Dynamic Management of Authorization Information:</strong> The system must allow creation, removal, updating, and deletion of authorization information for agents, as agents can be highly dynamic.</li>
                <li><strong>Security and Privacy:</strong> Ensuring secure and private sharing of authorization information across domains.</li>
                <li><strong>Compliance and Auditability:</strong> Support for compliance with regulatory standards and auditability of authorization exchanges.</li>
            </ul>
            <section>
                <name>Solution Approach 1: Dynamic Client Registration (RFC 7591)</name>
                <t><strong>Description:</strong> Dynamic Client Registration as outlined in <xref target="RFC7591"/> allows clients to register with an AS dynamically, facilitating the management of client credentials and metadata.</t>
                <t>
                    <strong>Discussion:</strong>
                </t>
                <table>
                    <thead>
                        <tr>
                            <th>Requirement</th>
                            <th>Met or Partially Met</th>
                            <th>Not Met</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Dynamic Identity for Agents and MCP Servers</td>
                            <td>Met</td>
                            <td/>
                        </tr>
                        <tr>
                            <td>Interoperability Across Domains</td>
                            <td>Partially Met (Granted by the Dynamic Registration, however no common ground between AS)</td>
                            <td/>
                        </tr>
                        <tr>
                            <td>Flexible Definition of Claims</td>
                            <td/>
                            <td>Not Met (OAuth2 claims only)</td>
                        </tr>
                        <tr>
                            <td>Dynamic Management of Authorization Information</td>
                            <td/>
                            <td>Not Met (Delete or Update not supported)</td>
                        </tr>
                        <tr>
                            <td>Security and Privacy</td>
                            <td/>
                            <td>Not Met (Claims are shared but no common schema)</td>
                        </tr>
                        <tr>
                            <td>Compliance and Auditability</td>
                            <td>Partially Met (Claims are shared, APIs are auditable, but no regulatory standards are defined for the schema)</td>
                            <td/>
                        </tr>
                    </tbody>
                </table>
            </section>
            <section>
                <name>Solution Approach 2: SCIM extensions</name>
                <t><xref target="I-D.abbey-scim-agent-extension"/> proposes extending the SCIM (System for Cross-Domain Identity Management) protocol to standardize the provisioning, management, and governance of AI agents and other digital workers.</t>
                <t><xref target="I-D.wahl-scim-agent-schema"/> is a companion document to the draft-abbey-scim-agent-extension. Its purpose is to define the specific SCIM schema and attributes required to represent AI agents (digital workers) and agentic applications within the SCIM framework.</t>
                <t><strong>Description:</strong> Provision Agents / MCP Servers through a SCIM extension.</t>
                <t>
                    <strong>Discussion:</strong>
                </t>
                <table>
                    <thead>
                        <tr>
                            <th>Requirement</th>
                            <th>Met or Partially Met</th>
                            <th>Not Met</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Dynamic Identity for Agents and MCP Servers</td>
                            <td>Partially Met (SCIM support is limited and with constraints, example for Azure: “Subsequent syncs are triggered every 20-40 minutes”.)</td>
                            <td/>
                        </tr>
                        <tr>
                            <td>Interoperability Across Domains</td>
                            <td>Partially Met (SCIM is supported and schema is well defined)</td>
                            <td/>
                        </tr>
                        <tr>
                            <td>Flexible Definition of Claims</td>
                            <td>Met (Defined by the schema)</td>
                            <td/>
                        </tr>
                        <tr>
                            <td>Dynamic Management of Authorization Information</td>
                            <td>Partially Met (SCIM support is limited and with constraints, example for Azure: “Subsequent syncs are triggered every 20-40 minutes”.)</td>
                            <td/>
                        </tr>
                        <tr>
                            <td>Security and Privacy</td>
                            <td>Partially Met (A schema is defined but Selective Disclosure not supported)</td>
                            <td/>
                        </tr>
                        <tr>
                            <td>Compliance and Auditability</td>
                            <td>Partially Met (Claims are shared, APIs are auditable, but no regulatory standards are defined for the schema)</td>
                            <td/>
                        </tr>
                    </tbody>
                </table>
            </section>
            <section>
                <name>Solution Approach 3: Client-ID Metadata</name>
                <t><strong>Description:</strong> Client ID Metadata <xref target="I-D.ietf-oauth-client-id-metadata-document"/> is a method for OAuth clients to identify themselves using a URL, which points to a JSON file containing their OAuth metadata. Instead of requiring pre-registration, an authorization server can fetch this JSON document at the client's provided URL to provision the identity.</t>
                <t>
                    <strong>Discussion:</strong>
                </t>
                <table>
                    <thead>
                        <tr>
                            <th>Requirement</th>
                            <th>Met or Partially Met</th>
                            <th>Not Met</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Dynamic Identity for Agents and MCP Servers</td>
                            <td>Met</td>
                            <td/>
                        </tr>
                        <tr>
                            <td>Interoperability Across Domains</td>
                            <td>Met</td>
                            <td/>
                        </tr>
                        <tr>
                            <td>Flexible Definition of Claims</td>
                            <td/>
                            <td>Not Met* (client_id is common, all the rest is limited to OAuth2 claims)</td>
                        </tr>
                        <tr>
                            <td>Dynamic Management of Authorization Information</td>
                            <td>Met</td>
                            <td/>
                        </tr>
                        <tr>
                            <td>Security and Privacy</td>
                            <td>Partially Met** (A schema is defined but Selective Disclosure not supported)</td>
                            <td/>
                        </tr>
                        <tr>
                            <td>Compliance and Auditability</td>
                            <td>Partially Met** (Claims are shared, APIs are auditable, but no regulatory standards are defined for the schema)</td>
                            <td/>
                        </tr>
                    </tbody>
                </table>
                <t><strong>*Flexible Definition of Claims:</strong> The OAuth claims in the draft follow the claims exposed and defined by IANA OAuth Parameters. Hence, the metadata fields are limited to a fixed set of claims. This makes it difficult to convey richer features about the client, including provenance details, compliance attestations, or contextual trust scores without introducing vendor-specific extensions, thereby reducing portability and interoperability.</t>
                <t><strong>**Security and Privacy, Compliance and Auditability:</strong> All metadata is published to a publicly accessible endpoint. There is no native ability to keep certain attributes private, apply selective disclosure, or restrict visibility based on trust relationships. Sensitive operational data or compliance-related data must be handled outside the metadata framework, leading to fragmented trust models. There is no mechanism for revocation and expiration.</t>
            </section>
            <section>
                <name>Solution Approach 4: Client-ID Metadata + W3C Verifiable Credentials Extension</name>
                <figure>
                    <name>Client-ID Metadata with VC Verification Flow</name>
                    <artwork type="ascii-art"><![CDATA[
Agent (Client)             AuthZ Server (AS)         Metadata Endpoint
      |                            |                      |
      | 1. Authorization Request   |                      |
      |    (client_id = URL)       |                      |
      |--------------------------->|                      |
      |                            |                      |
      |                            | 2. HTTP GET (URL)    |
      |                            |--------------------->|
      |                            |                      |
      |                            | 3. Returns Metadata  |
      |                            |    (JWKS + "vc+jwt") |
      |                            |<---------------------|
      |                            |                      |
      |                            | 4. Validate Metadata |
      |                            |    & Verify VC Signature (JWKS)
      |                            |                      |
]]></artwork>
                </figure>
                <t><strong>Description:</strong> The proposed solution is based on Solution 3, but enhances the supported claims with a new claim, "vc+jwt", based on the Verifiable Credentials Data Model 2.0 from W3C.</t>
                <dl>
                    <dt>vc+jwt</dt>
                    <dd>A standard method used in decentralized identity to package and secure a digital credential. The Verifiable Credential (VC)—the actual data proving a fact (e.g., identity or degree)—is encapsulated within a JSON Web Token (JWT), which provides a cryptographic signature from the issuer. This signature allows any third party (the Verifier) to instantly confirm the credential's authenticity and integrity. Modern formats like SD-JWT VC further enhance this by enabling the holder to share only specific parts of the credential (Selective Disclosure) to protect privacy.</dd>
                </dl>
                <t>
                    <strong>Discussion:</strong>
                </t>
                <table>
                    <thead>
                        <tr>
                            <th>Requirement</th>
                            <th>Met or Partially Met</th>
                            <th>Not Met</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Dynamic Identity for Agents and MCP Servers</td>
                            <td>Met</td>
                            <td/>
                        </tr>
                        <tr>
                            <td>Interoperability Across Domains</td>
                            <td>Met (1)</td>
                            <td/>
                        </tr>
                        <tr>
                            <td>Flexible Definition of Claims</td>
                            <td>Met (2)</td>
                            <td/>
                        </tr>
                        <tr>
                            <td>Dynamic Management of Authorization Information</td>
                            <td>Met</td>
                            <td/>
                        </tr>
                        <tr>
                            <td>Security and Privacy</td>
                            <td>Met (3)</td>
                            <td/>
                        </tr>
                        <tr>
                            <td>Compliance and Auditability</td>
                            <td>Met (4)</td>
                            <td/>
                        </tr>
                    </tbody>
                </table>
                <t>
                    <strong>Detailed explanations:</strong>
                </t>
                <t>The W3C Verifiable Credentials Data Model 2.0 addresses the shortcomings of the previous Solution 3, by introducing a cryptographically verifiable and standards-based way to assert identities, capabilities, and compliance attestations. It supports selective disclosure to protect sensitive information, enables time-bound and revocable authorizations, and ensures provenance tracking for audit and regulatory compliance. They are part of a broader decentralized identity (DID) specification.</t>
                <t>Using the W3C Verifiable Credentials Data Model 2.0 for Agents, MCP Clients, and MCP Servers provides a standardized, cryptographically secure way to establish trust, delegate authority, and ensure interoperability across different systems.</t>
                <t>It enables Agents, MCP Clients, and MCP Servers to prove, among other things, their identities, identity issuers and provenance, supported skills and permitted actions through verifiable proofs, including support for fine-grained and time-bound access control, while maintaining transparency enabling audit trails for compliance.</t>
                <t>Additionally, it enhances privacy through selective disclosure and privacy-preserving proofs (e.g., allowing Agents to prove skills and authorized actions without exposing unnecessary details).</t>
                <t>The Verifiable Credentials Data Model 2.0 is a W3C standard that fits the needs expressed above:</t>
                <t><strong>(1) Enhanced Interoperability:</strong> VCDM 2.0 provides a standardized, extensible way to express identities, capabilities, and compliance data across different systems. Its use of DIDs and schema-governed claims ensures that Agents, MCP Clients, and MCP Servers can verify and exchange trust information, enabling consistent interoperability across domains and platforms.</t>
                <t><strong>(2) Flexible Definition of Claims:</strong> VCDM 2.0 allows arbitrary, schema-governed claims that can represent complex concepts such as provenance, software supply-chain attestations (e.g., SLSA), security posture, audit certifications (SOC2, ISO-27001), or dynamic trust signals. These claims can be extended without breaking interoperability, thanks to widely adopted JSON-LD and schema registries.</t>
                <t><strong>(3) Security and Privacy:</strong> Credentials are signed using verifiable cryptographic proofs (e.g., JSON Web Signatures, Data Integrity proofs). This ensures that Agents, MCP clients, and MCP servers can verify the authenticity of claims without relying solely on HTTPS endpoints or centralized registries. Through techniques like BBS+ signatures, holders can disclose only the subset of claims required for a given authorization flow. This is essential for scenarios where Agents must prove capabilities (e.g., "I'm allowed to execute this skill") without revealing unnecessary or sensitive identity attributes.</t>
                <t><strong>(4) Compliance and Auditability:</strong> VCDM 2.0 enables cryptographically verifiable audit trails by binding each credential to an issuer, timestamp, and revocation status. Compliance attestations can be embedded directly in credentials, and real-time revocation checks ensure they remain valid. This provides trustworthy provenance, regulatory-grade accountability, and reliable lifecycle tracking across distributed systems.</t>
            </section>
        </section>
        <section>
            <name>Example using Outshift Identity Service + Okta (IdP)</name>
            <section>
                <name>Metadata example</name>
                <sourcecode name="metadata-example.json" type="json"><![CDATA[
{
  "client_id": "https://identity_service/mcp-001/oauth/client-metadata.json",
  "client_name": "Example CIMD Client",
  "jwks_uri": "https://identity-service/XYZ/.well-known/jwks.json",
  "token_endpoint_auth_method": "private_key_jwt",
  "vc+jwt": "{VC with JOSE envelope}"
}
]]></sourcecode>
            </section>
            <section>
                <name>VC example</name>
                <sourcecode name="vc-example.json" type="json"><![CDATA[
{
  "@context": [
    "https://www.w3.org/2018/credentials/v1",
    "https://example.org/mcp-server/schema/v1"
  ],
  "type": ["VerifiableCredential", "McpServerCredential"],
  "issuer": "did:web:XYZ.okta.com",
  "jwks_uri": "https://identity-service/XYX/.well-known/jwks.json",
  "issuanceDate": "2025-11-10T00:00:00Z",
  "credentialSubject": {
    "id": "https://identity_service/mcp-001/oauth/client-metadata.json",
    "name": "MCP-001",
    "version": "3.2.1",
    "compliance": ["ISO-27001", "GDPR"],
    "trustScore": 0.94
  },
  "proof": {
    "type": "Ed25519Signature2020",
    "created": "2025-11-10T00:00:00Z",
    "proofPurpose": "assertionMethod",
    "verificationMethod": "did:web:identity-service/XYZ#keys-1",
    "jws": "eyJhbGciOiJFZERTQSJ9..xyzsignature"
  }
}
]]></sourcecode>
            </section>
        </section>
        <section anchor="IANA">
            <name>IANA Considerations</name>
            <t>This memo includes no request to IANA.</t>
        </section>
        <section anchor="Security">
            <name>Security Considerations</name>
            <t>The security considerations for this document are discussed in the "Security and Privacy" requirements and solution analysis sections.</t>
        </section>
    </middle>
    <back>
        <references>
            <name>References</name>
            <references>
                <name>Informative References</name>
                <reference anchor="RFC7591" target="https://www.rfc-editor.org/info/rfc7591">
                    <front>
                        <title>OAuth 2.0 Dynamic Client Registration Protocol</title>
                        <author initials="J." surname="Richer" role="editor"/>
                        <author initials="M." surname="Jones"/>
                        <author initials="J." surname="Bradley"/>
                        <author initials="M." surname="Machulak"/>
                        <author initials="P." surname="Hunt"/>
                        <date year="2015" month="July"/>
                    </front>
                </reference>
                <reference anchor="I-D.abbey-scim-agent-extension">
                    <front>
                        <title>SCIM Extensions for Agents</title>
                        <author surname="Abbey" initials="J."/>
                        <date year="2025"/>
                    </front>
                </reference>
                <reference anchor="I-D.wahl-scim-agent-schema">
                    <front>
                        <title>SCIM Schema for Agents</title>
                        <author surname="Wahl" initials="M."/>
                        <date year="2025"/>
                    </front>
                </reference>
                <reference anchor="I-D.ietf-oauth-client-id-metadata-document">
                    <front>
                        <title>OAuth 2.0 Client Identity Metadata Document</title>
                        <author surname="Jones" initials="M."/>
                        <author surname="Sakimura" initials="N."/>
                        <author surname="Bradley" initials="J."/>
                        <date year="2025"/>
                    </front>
                </reference>
                <reference anchor="W3C.VCDM2.0" target="https://www.w3.org/TR/vc-data-model-2.0/">
                    <front>
                        <title>Verifiable Credentials Data Model v2.0</title>
                        <author>
                            <organization>W3C</organization>
                        </author>
                        <date year="2024"/>
                    </front>
                </reference>
            </references>
        </references>
    </back>
</rfc>
